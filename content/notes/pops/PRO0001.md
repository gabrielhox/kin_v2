---
title: "PRO-0001 - UtilizaÃ§Ã£o da ferramenta KIN Auditoria de Frete"
---

# REUNINDO OS ARQUIVOS NECESSÃRIOS

A ferramenta foi construÃ­da para trabalhar com mudanÃ§a constante de informaÃ§Ãµes, para isso, Ã© necessÃ¡rio fornecer bases de dados sempre atualizadas e coerentes com o perÃ­odo da fatura analizada.



## RELATÃ“RIOS

> ğŸ¤¯ AtenÃ§Ã£o! Para realizaÃ§Ã£o desta etapa Ã© necessÃ¡rio que o usuÃ¡rio tenha o mÃ³dulo **DICFM001** liberado em seu perfil. Antes de inciarmos, certifique-se de que a sua mÃ¡quina possui o caminho `C:/temp`, pois Ã© nele que serÃ£o salvos os relatÃ³rios necessÃ¡rios.

1. Pesquise pelo mÃ³dulo **DICFM001** na [barra de pesquisa](VTA0001.md) do TOTVS.

2. Na tela inicial do **Virtual Report**, na aba "EXPORTAÃ‡ÃƒO DE DADOS" selecione o relatÃ³rio "**CUBAGEM POR ITEM NF (AUDITORIA DE FRETE) V3**", e pressione **ENTER**:

![Acesso RelatÃ³rio DICFM001](https://i.imgur.com/dEevR7z.gif)

3. Preencha os campos de acordo com as necessidades especÃ­ficas:

![Requerimento InformaÃ§Ãµes RelatÃ³rio](https://i.imgur.com/OWuV278.png)

>> 1. Selecione a Empresa;
>> 2. Insira o intervalo da Data de EmissÃ£o;
>> 3. Insira o CÃ³digo da Transportadora.

>>> ğŸ¤” OBS â†’ A empresa sugerida no `item 1` serÃ¡ sempre a empresa a qual o usuÃ¡rio estÃ¡ logado; o intervalo da data de emissÃ£o sugerido depende das datas da fatura, Ã© recomendado emitir pelo menos os Ãºltimos 2 meses atÃ© a data de vencimento da fatura; o cÃ³digo da transportadora Ã© o nÃºmero que a identifica dentro da base de dados do TOTVS Moda!

4. Pressione a tecla `F9` para processar, e aguarde o Plano de CÃ¡lculo:

![ExecuÃ§Ã£o do Plano de CÃ¡lculo](https://i.imgur.com/gRcAHom.png)

5. Na janela seguinte, Ã© necessÃ¡rio localizar a pasta criada anteriormente:

![DiÃ¡logo SeleÃ§Ã£o de Pasta](https://i.imgur.com/6QoJIbG.gif)

>> No exemplo foi selecionado o disco `M:`, que possui o nome "Client C" na caixa de diÃ¡logo. Embora seja muito comum que o disco **C** esteja mapeado a unidade **M** no TOTVS Moda, nÃ£o Ã© uma regra. Escolha o disco que esteja mapeado ao **C** da sua mÃ¡quina.

6. Preencha o restante do *caminho* com o nome da TRANSPORTADORA em questÃ£o, e pressione **Confirmar** ou `F9`:

![Preencher Nome Transportadora no Caminho](https://i.imgur.com/Stcny2T.gif)

7. Aguarde a finalizaÃ§Ã£o da tarefa, e pressione **"Cancelar"** para nÃ£o abrir o arquivo no sistema TOTVS:

![TÃ©rmino de GeraÃ§Ã£o de RelatÃ³rio](https://i.imgur.com/OCGpl2q.png)

>> ğŸ¤” Este processo precisa ser realizado para cada uma das transportadoras cujas faturas serÃ£o processadas!

>>> ğŸ¤” Todos os arquivos gerados devem ser mantidos no caminho especificado, nÃ£o Ã© recomendado que os relatÃ³rios gerados sejam aberto manualmente em softwares de planilha (como Excel, LibreOffice ou WPS), pois tendem a alterar a codificaÃ§Ã£o do arquivo, que pode gerar erros posteriormente!

## FATURAS

1. As faturas em formato PDF devem ser colocadas no seguinte caminho:

`~\kin-audit\assets\invoice\pdfs`

![Caminhando Diretorios PDFs Faturas](https://i.imgur.com/Aza7sAW.gif)

2. As faturas da **DL Cargas / Luzza** possuem um formato diferente, e ainda sÃ£o suportadas, entÃ£o Ã© necessÃ¡rio converte-las [manualmente]().

## PROCESSO

1. HÃ¡ um arquivo executÃ¡vel, com o nome de **"executar"**, dÃª um duplo clique:

![ExecutÃ¡vel do Kin Auditoria](https://i.imgur.com/sVC8dJ4.png)

2. A linha de comando irÃ¡ iniciar, e a primeira informaÃ§Ã£o que recebemos, Ã© a lista de relatÃ³rios contida na pasta `C:/temp`, que foram gerados anteriormente:

![Lista de RelatÃ³rios Kin Auditoria Terminal](https://i.imgur.com/NNKbwCj.png)

>> Apenas digite o nÃºmero correspondente ao relatÃ³rio que irÃ¡ utilizar! No exemplo vamos seguir com a **SUDOESTE** que nesta instÃ¢ncia esta representada pelo nÃºmero `12`. Ao digitar o nÃºmero pressione ENTER para *confirmar*.

3. ApÃ³s confirmar, o Kin Auditoria irÃ¡ listar todas as faturas contidas nas pasta, de acordo com o [passo 1](link_header_passo_1).

![Lista de Faturas PDF Kin Auditoria Terminal](https://i.imgur.com/t3FoLsi.png)

>> Novamente, digite o nÃºmero relacionado a fatura que deseja recalcular, neste caso selecione a fatura correspondente ao nÃºmero 7, e pressione ENTER para confirmar.

4. **Se a fatura for convertida corretamente**, o Kin Auditoria irÃ¡ abri-la ja em formato de planilha, para que apenas as colunas corretas sejam mantidas:

![Abertua de Fatura EdiÃ§Ã£o Kin Auditoria Terminal](https://i.imgur.com/nq4yMJg.gif)

5. Aqui sÃ£o deletadas as colunas indesejadas, e sÃ£o mantidas apenas as colunas necessÃ¡rias para a realizaÃ§Ã£o do cÃ¡lculo. Vamos olhar quais colunas estÃ£o disponÃ­veis no arquivo aberto:

![Colunas Fatura EdiÃ§Ã£o Kin Auditoria Terminal](https://i.imgur.com/SvxWePs.png)

* **1** ou *A* â†’ Coluna de Ãndices, adicionada pelo sistema;<br>
* **2** ou *B* â†’ Parte do nÃºmero do CTE de acordo com a Fatura PDF;<br>
* **3** ou *C* â†’ NÃºmero do CTE;<br>
* **4** ou *D* â†’ Data de emissÃ£o;<br>
* **5** ou *E* â†’ NÃºmero do CPF/CNPJ do cliente;<br>
* **6** ou *F* â†’ Nome do cliente;<br>
* **7** ou *G* â†’ Parte do nÃºmero da NF de acordo com a Fatura PDF;<br>
* **8** ou *H* â†’ NÃºmero NF;<br>
* **9** ou *I* â†’ Valor da NF;<br>
* **10** ou *J* â†’ Peso como consta na NF;<br>
* **11** ou *K* â†’ Base de CÃ¡lculo do ICMS;<br>
* **12** ou *L* â†’ ICMS;<br>
* **13** ou *M* â†’ ISS;<br>
* **14** ou *N* â†’ ST;<br>
* **15** ou *O* â†’ Valor do Frete;<br>

> ğŸš« As colunas a serem deletadas sÃ£o: 1, 2, 4, 5, 6, 7, 11, 12, 13, 14.

> â›” NÃ£o delete a primeira linha, ela serÃ¡ preenchida com os nomes das colunas posteriormente!

![ExclusÃ£o de Colunas EdiÃ§Ã£o Kin Auditoria Terminal](https://i.imgur.com/dXHc5h0.gif)

O Arquivo final deve ter a seguinte estrutura:

![Estrutura Final EdiÃ§Ã£o Fatura Kin Auditoria](https://i.imgur.com/WoSLACw.png)

  **1.** NÃºmero do CTE;
  **2.** NÃºmero da NF;
  **3.** Valor da NF;
  **4.** Peso como consta na NF;
  **5.** Valor do Frete;

Ao finalizar a ediÃ§Ã£o, salve (como .csv) e feche o arquivo.

> â›” NÃ£o salve o arquivo como **.xlsx** pois este formato nÃ£o Ã© suportado pelo script do Kin Auditoria!

6. Retorne a janela do Kin Auditora e pressione **ENTER** para continuar, o script irÃ¡ retornar uma lista com os nomes das Transportadoras, digite o nÃºmero correspondente e pressione **ENTER** para continuar:

![Escolha da Transportadora](https://i.imgur.com/NdrNYjL.gif)

7. Escolha N (NÃ£o) para a utilizaÃ§Ã£o de arquivos do usuÃ¡rio:

![UtilizaÃ§Ã£o de Arquivos do UsuÃ¡rio - Teste Apenas](https://i.imgur.com/B2APlIY.gif)


8. Insira a alÃ­quota do ICMS em formato decimal (insira 0,12 para 12% por exemplo), se nÃ£o houver ICMS apenas insira 0 e pressione **ENTER** para continuar:

![Input Aliquota de ICMS Kin Auditora Terminal](https://i.imgur.com/ArIzJWt.gif)

> Neste caso a fatura nÃ£o possuia incidÃªncia de ICMS, entÃ£o o valor fornecido foi `0`!

9. Responda S (Sim) para salva a fatura resumida e N (NÃ£o) para visualizaÃ§Ã£o da fatura em console:

![https://i.imgur.com/kCSnM1R.gif](https://i.imgur.com/kCSnM1R.gif)

> A Ãºltima linha retornada, informa o tempo de execuÃ§Ã£o da instÃ¢ncia, basta pressionar a tecla **ENTER** que a janela se fecharÃ¡.

10. Em sua pasta raÃ­z (onde estÃ¡ localizado o arquivo do script) serÃ£o criados 2 aquivos:

![Arquivos Gerados](https://i.imgur.com/MeGgsnG.png)

> 1. Este arquivo Ã© fatura recalculada, o arquivo final;
> 2. Este arquivo Ã© apenas o texto da fatura convertida, para fins de conferÃªncia.

### Feedback

> Esta ferramente ainda estÃ¡ em fase de testes, estamos montando uma lista de bugs a serem concertados e recursos que poderiam ser adicionados. Caso queira contribuir, baste responder estas 3 perguntinhas [aqui](https://forms.gle/tRv2zijobn84gawh6)! ğŸ†